import{a as R,c as V,d as j,e as A,g as c,h as G,i as M,j as U,k as O,m as W,n as $}from"./chunk-44OGPJAH.js";import{a as I}from"./chunk-QBPXQQW3.js";import{Ba as w,Ca as u,Da as L,Ha as d,Ja as N,O as b,Q as y,R as _,T as C,ba as a,fb as T,ga as l,hb as x,ia as S,l as v,lb as D,mb as h,sa as F,ta as E,ua as k,va as m,wa as o,xa as n,ya as p}from"./chunk-NACUJKL6.js";import{a as f,b as g}from"./chunk-2VMXMS7J.js";function P(s,B){if(s&1){let e=w();o(0,"span",13)(1,"i",15),u("click",function(){let i=y(e).$implicit,r=L();return _(r.removeTag(i))}),n(),d(2),n()}if(s&2){let e=B.$implicit;a(2),N(" ",e," ")}}var ie=(()=>{class s{constructor(e,t,i,r){this.articleService=e,this.route=t,this.router=i,this.userService=r,this.tagList=[],this.articleForm=new A({title:new c("",{nonNullable:!0}),description:new c("",{nonNullable:!0}),body:new c("",{nonNullable:!0})}),this.tagField=new c("",{nonNullable:!0}),this.errors=null,this.isSubmitting=!1,this.destroyRef=b(C)}ngOnInit(){this.route.snapshot.params.slug&&v([this.articleService.get(this.route.snapshot.params.slug),this.userService.getCurrentUser()]).pipe(h(this.destroyRef)).subscribe(([e,{user:t}])=>{t.username===e.author.username?(this.tagList=e.tagList,this.articleForm.patchValue(e)):this.router.navigate(["/"])})}addTag(){let e=this.tagField.value;e!=null&&e.trim()!==""&&this.tagList.indexOf(e)<0&&this.tagList.push(e),this.tagField.reset("")}removeTag(e){this.tagList=this.tagList.filter(t=>t!==e)}submitForm(){this.isSubmitting=!0,this.addTag();let e=this.route.snapshot.params.slug,t=g(f({},this.articleForm.value),{tagList:this.tagList});(e?this.articleService.update(g(f({},t),{slug:e})):this.articleService.create(t)).pipe(h(this.destroyRef)).subscribe({next:r=>this.router.navigate(["/article/",r.slug]),error:r=>{this.errors=r,this.isSubmitting=!1}})}static{this.\u0275fac=function(t){return new(t||s)(l(I),l(T),l(x),l(D))}}static{this.\u0275cmp=S({type:s,selectors:[["app-editor-page"]],decls:21,vars:4,consts:[[1,"editor-page"],[1,"container","page"],[1,"row"],[1,"col-md-10","offset-md-1","col-xs-12"],[3,"errors"],[3,"formGroup"],[3,"disabled"],[1,"form-group"],["formControlName","title","type","text","placeholder","Article Title",1,"form-control","form-control-lg"],["formControlName","description","type","text","placeholder","What's this article about?",1,"form-control"],["formControlName","body","rows","8","placeholder","Write your article (in markdown)",1,"form-control"],["type","text","placeholder","Enter tags",1,"form-control",3,"keyup.enter","formControl"],[1,"tag-list"],[1,"tag-default","tag-pill"],["type","button",1,"btn","btn-lg","pull-xs-right","btn-primary",3,"click"],[1,"ion-close-round",3,"click"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p(4,"app-list-errors",4),o(5,"form",5)(6,"fieldset",6)(7,"fieldset",7),p(8,"input",8),n(),o(9,"fieldset",7),p(10,"input",9),n(),o(11,"fieldset",7)(12,"textarea",10),d(13,"              "),n()(),o(14,"fieldset",7)(15,"input",11),u("keyup.enter",function(){return i.addTag()}),n(),o(16,"div",12),E(17,P,3,1,"span",13,F),n()(),o(19,"button",14),u("click",function(){return i.submitForm()}),d(20," Publish Article "),n()()()()()()()),t&2&&(a(4),m("errors",i.errors),a(),m("formGroup",i.articleForm),a(),m("disabled",i.isSubmitting),a(9),m("formControl",i.tagField),a(2),k(i.tagList))},dependencies:[$,W,G,R,V,j,M,U,O],encapsulation:2})}}return s})();export{ie as default};
